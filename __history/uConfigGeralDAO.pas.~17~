unit uConfigGeralDAO;

interface

uses
  uConfigGeral, uConexao, System.SysUtils, FireDAC.Comp.Client, FireDAC.Stan.Param;

type
  TConfigGeralDAO = class
  public
    function AlterarConfiguracao(AColuna: String; ANovoValor: Variant): Boolean;
  end;

implementation

function TConfigGeralDAO.AlterarConfiguracao(AColuna: String; ANovoValor: Variant): Boolean;
var
  Qry: TFDQuery;
begin
  Result := False;
  Qry := TFDQuery.Create(nil);

  try
    Qry.Connection.Name := 'DBSavr';
    Qry.SQL.Text := 'UPDATE configuracao SET ' + AColuna + ' = :Valor WHERE id = 1';
    Qry.ParamByName('Valor').Value := ANovoValor;
    Qry.ExecSQL;

    Result := True;
  finally
    Qry.Free;
  end;
end;

end.
